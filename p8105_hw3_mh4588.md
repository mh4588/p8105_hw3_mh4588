p8105_hw3_mh4588.Rmd
================
Maggie Hsu
2024-10-16

### Data Exploration

``` r
library(tidyverse) #Import the Tidyverse library and additional libraries
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.3     ✔ tidyr     1.3.1
    ## ✔ purrr     1.0.2     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(p8105.datasets)
library(ggridges)
library(patchwork)


data("ny_noaa") #Load NOAA data from the datasets library
```

# Problem 2

``` r
#Read in datasets
covar <- read.csv("./data/nhanes_covar.csv")
accel <- read.csv("./data/nhanes_accel.csv")

#Clean the covar data frame
#Rename rows and remove first four blank rows
covar <- janitor::row_to_names(covar, 4) |>
  filter(age >= 21) |> #Exclude participants under 21 years old
  mutate( #Encode variables into appropriate classes
    SEQN = as.numeric(SEQN),
    sex = factor(sex, labels=c("male","female")),
    age = as.numeric(age), 
    BMI = as.numeric(BMI),
    education = factor(education, labels = c("Less than High School","High School Equivalent", "More than High School")),
  )

#Clean accel data frame
accel <- 

#Merge frames based on SEQN
nhanes <- left_join(covar,accel, by="SEQN") |>
  #Remove rows with missing demographic values
  drop_na(SEQN,sex,age,BMI,education)
```

``` r
#Set up table comparing the number of men and women in each level of education
nhanes |>
  janitor::tabyl(sex, education)
```

    ##     sex Less than High School High School Equivalent More than High School
    ##    male                    27                     35                    56
    ##  female                    28                     23                    59

``` r
#Visualization
nhanes |>
  group_by(sex, education) |>
  ggplot(aes(x = education, y = sex, fill = sex)) + 
    geom_bar(stat='identity') +
    facet_grid(~sex) +
    scale_x_discrete(labels = scales::label_wrap(10))
```

![](p8105_hw3_mh4588_files/figure-gfm/nhanes%20table-1.png)<!-- -->

# Problem 3

``` r
#Read in data
jan_2020 <- read.csv("./data/citibike/Jan 2020 Citi.csv") 
jan_2024 <- read.csv("./data/citibike/Jan 2020 Citi.csv")
july_2020 <- read.csv("./data/citibike/July 2020 Citi.csv")
july_2024 <- read.csv("./data/citibike/July 2024 Citi.csv")

#Add identifier variables
jan_2020 = mutate(jan_2020, month = "January 2020")
jan_2024 = mutate(jan_2024, month = "January 2024")
july_2020 = mutate(july_2020, month = "July 2020")
july_2024 = mutate(july_2024, month = "July 2024")

#Merge all datasets
citibike <- bind_rows(jan_2020, jan_2024, july_2020, july_2024)
```

``` r
citibike |>
  group_by(member_casual, month) |>
  summarize(total_rides = n()) 
```

    ## `summarise()` has grouped output by 'member_casual'. You can override using the
    ## `.groups` argument.

    ## # A tibble: 8 × 3
    ## # Groups:   member_casual [2]
    ##   member_casual month        total_rides
    ##   <chr>         <chr>              <int>
    ## 1 casual        January 2020         984
    ## 2 casual        January 2024         984
    ## 3 casual        July 2020           5637
    ## 4 casual        July 2024          10894
    ## 5 member        January 2020       11436
    ## 6 member        January 2024       11436
    ## 7 member        July 2020          15411
    ## 8 member        July 2024          36262

## The 5 most popular starting stations in July 2024

``` r
citibike |>
  filter(month=="July 2024") |>
  group_by(start_station_name) |>
  summarize(originating_rides = n())|>
  filter(min_rank(desc(originating_rides)) < 6)
```

    ## # A tibble: 5 × 2
    ##   start_station_name       originating_rides
    ##   <chr>                                <int>
    ## 1 Pier 61 at Chelsea Piers               163
    ## 2 University Pl & E 14 St                155
    ## 3 W 21 St & 6 Ave                        152
    ## 4 W 31 St & 7 Ave                        146
    ## 5 West St & Chambers St                  150

Make a plot to investigate the effects of day of the week, month, and
year on median ride duration. This plot can include one or more panels,
but should facilitate comparison across all variables of interest.
Comment on your observations from this plot.
