---
title: "p8105_hw3_mh4588.Rmd"
author: "Maggie Hsu"
date: "`r Sys.Date()`"
output: github_document
---

# Problem 1
The goal is to do some exploration of this dataset. To that end, write a short description of the dataset, noting the size and structure of the data, describing some key variables, and indicating the extent to which missing data is an issue. Then, do or answer the following (commenting on the results of each):

### Data Exploration
```{r load data and packages}
library(tidyverse) #Import the Tidyverse library and additional libraries
library(p8105.datasets)
library(ggridges)
library(patchwork)


data("ny_noaa") #Load NOAA data from the datasets library
```
The dataset "ny_noaa" consists of `r nrow(ny_noaa)` rows and `r ncol(ny_noaa)` variables, which are: `r names(ny_noaa)`. These variables describe each observation through its ID, date observed, and the levels of precipitation, snowfall, snow depth, and maximum/minimum temperatures. From the summary statistics of this dataset, missing data is an issue for the weather variables (precipitation, snowfall, snow depth, and temperature extremes) due to the amount of NAs present.

Summary Statistics Table:
`r knitr::kable(summary(ny_noaa))`

Tmax and Tmin have  tmax and tmin, which have  `r sum(is.na(pull(ny_noaa, var = tmax)))` and `r sum(is.na(pull(ny_noaa, var = tmin)))` NA values, respectively.


Ensure observations for temperature, precipitation, and snowfall are given in reasonable units.
For snowfall, what are the most commonly observed values? Why?

### Data Cleaning and Observations
```{r noaa cleaning}

#Created separate variables for year, month, and day and also converted minimum/maximum temperature variables into numeric values.
ny_noaa = 
  mutate(
    ny_noaa,
    date = ymd(date),
    year = year(date), 
    month = month(date), 
    day = day(date),
    tmax=as.numeric(tmax), 
    tmin = as.numeric(tmin)
    ) 

#Most commonly observed values for snowfall 
ny_noaa |>
  count(snow)
```

The most commonly observed value for snow is 0.

Make a two-panel plot showing the average max temperature in January and in July in each station across years. Is there any observable / interpretable structure? Any outliers?
### Average Maximum Temperatures in January and July By Station and Year
```{r january july}
january_tmax = #Average maximum temperature in January by year
  ny_noaa |>
  filter(month == 1) |>
  ggplot(aes(x=year, y = tmax, color="name")) +
  geom_point(alpha = .5) +
  patchwork::theme(legend.position = "none")

july_tmax= #Average maximum temperature in July by year
  ny_noaa |>
  filter(month == 7) |>
  ggplot(aes(x=year, y = tmax, color="name")) +
  geom_point(alpha = .5) +
  patchwork::theme(legend.position = "none")

january_tmax+july_tmax

```

Make a two-panel plot showing (i) tmax vs tmin for the full dataset (note that a scatterplot may not be the best option); and (ii) 
### Maximum vs. Minimum Temperatures
```{r tmax tmin}

# Tmax vs Tmin
```

### Distribution of Snowfall
make a plot showing the distribution of snowfall values greater than 0 and less than 100 separately by year.
```{r snowfall}
#Distribution of snowfall values by year
snowfall = ny_noaa |>
  filter(snow > 0, snow < 100) |>
  ggplot(aes(x=as.factor(year), y=snow))

snowfall
```

# Problem 2
```{r nhanes cleaning}
#Read in datasets
covar <- read.csv("data/nhanes_covar.csv")
accel <- read.csv("data/nhanes_accel.csv")

#Clean the covar data frame
#Rename rows and remove first four blank rows
covar <- janitor::row_to_names(covar, 4) |>
  filter(age >= 21) |> #Exclude participants under 21 years old
  mutate( #Encode variables into appropriate classes
    SEQN = as.numeric(SEQN),
    sex = factor(sex, labels=c("male","female")),
    age = as.numeric(age), 
    BMI = as.numeric(BMI),
    education = factor(education, labels = c("Less than High School","High School Equivalent", "More than High School")),
  )

#Clean accel data frame
accel <- 

#Merge frames based on SEQN
nhanes <- left_join(covar,accel, by="SEQN") |>
  #Remove rows with missing demographic values
  drop_na(SEQN,sex,age,BMI,education)
    
    
```

Produce a reader-friendly table for the number of men and women in each education category, and create a visualization of the age distributions for men and women in each education category. Comment on these items.
```{r nhanes table}
#Set up table comparing the number of men and women in each level of education
nhanes |>
  janitor::tabyl(sex, education)

#Visualization
nhanes |>
  group_by(sex, education) |>
  ggplot(aes(x = education, y = sex, fill = sex)) + 
    geom_bar(stat='identity') +
   facet_grid(. ~sex)
    
```
Traditional analyses of accelerometer data focus on the total activity over the day. Using your tidied dataset, aggregate across minutes to create a total activity variable for each participant. Plot these total activities (y-axis) against age (x-axis); your plot should compare men to women and have separate panels for each education level. Include a trend line or a smooth to illustrate differences. Comment on your plot.
```{r nhanes total activity}
```
Accelerometer data allows the inspection activity over the course of the day. Make a three-panel plot that shows the 24-hour activity time courses for each education level and use color to indicate sex. Describe in words any patterns or conclusions you can make based on this graph; including smooth trends may help identify differences.
```{r nhanes 24 hour}

```

# Problem 3
```{r citibike}


```